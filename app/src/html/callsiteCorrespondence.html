<!--
 * Copyright 2017-2020 Lawrence Livermore National Security, LLC and other
 * CallFlow Project Developers. See the top-level LICENSE file for details.
 * SPDX-License-Identifier: MIT
-->
<v-layout
    row
    wrap
    :id="id"
>
    <v-chip
        class="chip"
        chips
        color="teal"
        label
        outlined
        clearable
    > {{ message }} </v-chip>
    <v-spacer></v-spacer>
    <!-- <Settings ref="Settings" :settings="settings" /> -->
    <span class="component-info">
        <p> </p>
    </span>

    <v-layout
        row
        wrap
        v-if="isCallsiteSelected == true"
    >
        <v-btn
            class="ma-1 reveal-button"
            small
            tile
            outlined
            color="white"
            @click="clickCallsite"
        >
            Reveal
        </v-btn>
    </v-layout>

    <v-layout
        row
        wrap
        v-if="isModuleSelected == true"
    >
        <v-btn
            class="ma-1 reveal-button"
            small
            tile
            outlined
            color="white"
            :class="isEntryFunctionSelected"
            @click="showEntryFunctions"
        >
            Entry call sites
        </v-btn>
        <v-btn
            class="ma-1 reveal-button"
            small
            tile
            outlined
            color="white"
            :class="isCalleeSelected"
            @click="showExitFunctions"
        >
            Callees
        </v-btn>
        <v-spacer></v-spacer>
        <v-btn
            class="ma-1 reveal-button"
            small
            tile
            outlined
            color="white"
            v-if="showSplitButton == 'true'"
            @click="split"
        >
            Split
        </v-btn>
    </v-layout>

    <v-layout class="component-data">
        <p class="subtitle-2">Unmatched ({{numberOfDifferenceCallsites}} call sites). </p>
    </v-layout>
    <v-container
        class="auxiliary-node"
        v-for="callsite in differenceCallsites"
        :id="getID(callsite.id)"
    >
        <v-layout
            row
            wrap
        >
            <v-flex md1>
                <template>
                    <v-tooltip bottom>
                        <template v-slot:activator="{ on }">
                            <v-flex
                                :id="callsite.name"
                                text-xs-center
                                :class="selectClassName[callsite.name]"
                                @click="changeSelectedClassName"
                                style=''
                            >
                                {{formatNumberOfHops(callsite.component_level)}}
                            </v-flex>
                        </template>
                        <span>Component level: {{formatNumberOfHops(callsite.component_level)}}</span>
                    </v-tooltip>
                </template>

            </v-flex>
            <v-flex md9>
                <template>
                    <v-tooltip bottom>
                        <template v-slot:activator="{ on }">
                            <v-flex
                                class="pl-2 subtitle-2 font-weight-black"
                                v-on="on"
                            >
                                {{formatModule(callsite.module)}}={{formatName(callsite.name)}}
                            </v-flex>
                        </template>
                        <span>{{callsite.module}}={{callsite.name}}</span>
                    </v-tooltip>
                </template>
            </v-flex>

            <v-flex md2>
                <v-btn
                    :id="callsite.name"
                    icon
                    color=" lighten-2"
                    v-if="callsite.reveal == false"
                    @click=showIntersectionBoxPlot
                >
                    <v-icon>input</v-icon>
                </v-btn>
                <v-btn
                    :id="callsite.name"
                    icon
                    color="lighten-2"
                    v-if="callsite.reveal == true"
                    @click=hideIntersectionBoxPlot
                >
                    <v-icon>close</v-icon>
                </v-btn>
            </v-flex>
        </v-layout>

        <template v-if="callsite.reveal == false">
            <v-layout
                row
                wrap
            >
                <div
                    class="subtitle-2"
                    :style="'color: ' + targetColor"
                >Mean : {{targetMeans[callsite.name]}}</div>
                <v-spacer></v-spacer>
                <!-- <div class="subtitle-2" :style="'color: ' + targetColor">Variance : {{variance[callsite.name]}}</div> -->
                <div
                    class="subtitle-2"
                    :style="'color: ' + targetColor"
                >Std. Dev. :
                    {{targetStandardDeviation[callsite.name]}}
                </div>
            </v-layout>
        </template>
        <!-- <div>Percentage imbalance : {{callsite['imbalance_perc_inclusive']}}</div>
        <div>Skewness: {{callsite['skewness_inclusive']}}</div>
        <div>Kurtosis: {{callsite['kurtosis_inclusive']}}</div> -->
        <BoxPlot
            :ref="callsite.id"
            :callsite="callsite"
            showTarget=false
        />

        <template v-if="callsite.reveal == false">
            <v-layout
                row
                wrap
            >
                <div
                    class="subtitle-2"
                    :style="'color: ' + ensembleColor"
                >Mean : {{ensembleMeans[callsite.name]}}</div>
                <v-spacer></v-spacer>
                <!-- <div class="subtitle-2" :style="'color: ' + ensembleColor">Variance :
                    {{ensembleVariance[callsite.name]}}
                </div> -->
                <div
                    class="subtitle-2"
                    :style="'color: ' + ensembleColor"
                >Std. Dev. :
                    {{ensembleStandardDeviation[callsite.name]}}
                </div>
            </v-layout>
        </template>
    </v-container>


    <span class="component-data">
        <p class="subtitle-2">Matched ({{numberOfIntersectionCallsites}} call sites).</p>
    </span>
    <v-container
        class="auxiliary-node"
        v-for="callsite in intersectionCallsites"
        :id="getID(callsite.id)"
    >
        <v-layout
            row
            wrap
        >
            <v-flex md1>
                <v-card
                    width="20px"
                    class="mx-auto"
                    tile
                    outlined
                >
                    <v-flex
                        :id="callsite.name"
                        text-xs-center
                        :class="selectClassName[callsite.name]"
                        @click="changeSelectedClassName"
                    >
                        {{formatNumberOfHops(callsite.component_level)}}
                    </v-flex>
                </v-card>
            </v-flex>
            <v-flex md9>
                <template>
                    <v-tooltip bottom>
                        <template v-slot:activator="{ on }">
                            <v-flex
                                class="pl-2 subtitle-2 font-weight-black"
                                v-on="on"
                            >
                                {{formatModule(callsite.module)}}={{formatName(callsite.name)}}
                            </v-flex>
                        </template>
                        <span>{{callsite.module}}={{callsite.name}}</span>
                    </v-tooltip>
                </template>
            </v-flex>
            <v-flex md2>
                <v-btn
                    :id="callsite.name"
                    icon
                    color=" lighten-2"
                    v-if="callsite.reveal == false"
                    @click=showIntersectionBoxPlot
                >
                    <v-icon>input</v-icon>
                </v-btn>
                <v-btn
                    :id="callsite.name"
                    icon
                    color="lighten-2"
                    v-if="callsite.reveal == true"
                    @click=hideIntersectionBoxPlot
                >
                    <v-icon>close</v-icon>
                </v-btn>
            </v-flex>
        </v-layout>

        <template v-if="callsite.reveal == false">
            <v-layout
                row
                wrap
            >
                <div
                    class="subtitle-2"
                    :style="'color: ' + targetColor"
                >Mean : {{targetMeans[callsite.name]}}</div>
                <v-spacer></v-spacer>
                <!-- <div class="subtitle-2" :style="'color: ' + targetColor">Variance : {{variance[callsite.name]}}
                </div> -->
                <div
                    class="subtitle-2"
                    :style="'color: ' + targetColor"
                >Std. Dev. :
                    {{targetStandardDeviation[callsite.name]}}
                </div>
            </v-layout>
            <!-- <div>Percentage imbalance : {{callsite['imbalance_perc_inclusive']}}</div>
            <div>Skewness: {{callsite['skewness_inclusive']}}</div>
            <div>Kurtosis: {{callsite['kurtosis_inclusive']}}</div> -->
        </template>

        <template>
            <BoxPlot
                :ref="callsite.id"
                :callsite="callsite"
                showTarget=false
            />
        </template>



        <v-layout
            row
            wrap
        >
            <div
                class="subtitle-2"
                :style="'color: ' + ensembleColor"
            >Mean :
                {{ensembleMeans[callsite.name]}}</div>
            <v-spacer></v-spacer>
            <!-- <div class="subtitle-2" :style="'color: ' + ensembleColor">Std. Dev. :
                {{ensembleVariance[callsite.name]}}
            </div> -->
            <div
                class="subtitle-2"
                :style="'color: ' + ensembleColor"
            >Std. Dev. :
                {{ensembleStandardDeviation[callsite.name]}}
            </div>
        </v-layout>


        <v-layout
            row
            wrap
            v-if="callsite.reveal == true"
        >
            <v-flex
                md12
                class="body-2"
            >Ranks :
                {{selectedOutlierRanks}} </v-flex>
            <v-spacer></v-spacer>
            <v-flex
                md12
                class="body-2"
            >Datasets :
                {{selectedOutlierDatasets}}</v-flex>
        </v-layout>

    </v-container>
</v-layout>